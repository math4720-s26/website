<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.19">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Dr.&nbsp;Cheng-Han Yu   Department of Mathematical and Statistical Sciences   Marquette University">
<title>Regression  – MATH 4720 (MSSC 5720) - Spring 2026</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-46eeb4c476de49ef7df495821a6125d9.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-ac21d23c918e3e098212e454eda36928.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="../site_libs/quarto-contrib/live-runtime/live-runtime.js" type="module"></script>
<link href="../site_libs/quarto-contrib/live-runtime/live-runtime.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script type="module" src="../site_libs/quarto-ojs/quarto-ojs-runtime.js"></script><link href="../site_libs/quarto-ojs/quarto-ojs.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
<meta property="og:title" content="Regression r fontawesome::fa(&quot;people-arrows&quot;) – MATH 4720 (MSSC 5720) - Spring 2026">
<meta property="og:description" content="MATH 4720/MSSC 5720 Introduction to Statistics">
<meta property="og:image" content="https://math4720-s26.github.io/website/slides/15-regression_files/figure-revealjs/unnamed-chunk-3-1.png">
<meta property="og:site_name" content="MATH 4720 (MSSC 5720) - Spring 2026">
<meta property="og:image:height" content="5932">
<meta property="og:image:width" content="9600">
</head>
<body class="nav-sidebar docked quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Regression <svg aria-hidden="true" role="img" viewbox="0 0 640 512" style="height:1em;width:1.25em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M64 64a64 64 0 1 1 128 0A64 64 0 1 1 64 64zM25.9 233.4C29.3 191.9 64 160 105.6 160h44.8c27 0 51 13.4 65.5 34.1c-2.7 1.9-5.2 4-7.5 6.3l-64 64c-21.9 21.9-21.9 57.3 0 79.2L192 391.2V464c0 26.5-21.5 48-48 48H112c-26.5 0-48-21.5-48-48V348.3c-26.5-9.5-44.7-35.8-42.2-65.6l4.1-49.3zM448 64a64 64 0 1 1 128 0A64 64 0 1 1 448 64zM431.6 200.4c-2.3-2.3-4.9-4.4-7.5-6.3c14.5-20.7 38.6-34.1 65.5-34.1h44.8c41.6 0 76.3 31.9 79.7 73.4l4.1 49.3c2.5 29.8-15.7 56.1-42.2 65.6V464c0 26.5-21.5 48-48 48H496c-26.5 0-48-21.5-48-48V391.2l47.6-47.6c21.9-21.9 21.9-57.3 0-79.2l-64-64zM272 240v32h96V240c0-9.7 5.8-18.5 14.8-22.2s19.3-1.7 26.2 5.2l64 64c9.4 9.4 9.4 24.6 0 33.9l-64 64c-6.9 6.9-17.2 8.9-26.2 5.2s-14.8-12.5-14.8-22.2V336H272v32c0 9.7-5.8 18.5-14.8 22.2s-19.3 1.7-26.2-5.2l-64-64c-9.4-9.4-9.4-24.6 0-33.9l64-64c6.9-6.9 17.2-8.9 26.2-5.2s14.8 12.5 14.8 22.2z"></path></svg>
</li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto"><div class="pt-lg-2 mt-2 text-center sidebar-header">
      <a href="../index.html" class="sidebar-logo-link">
      <img src="../images/logo.png" alt="" class="sidebar-logo light-content py-0 d-lg-inline d-none"><img src="../images/logo.png" alt="" class="sidebar-logo dark-content py-0 d-lg-inline d-none"></a>
      <div class="sidebar-tools-main">
    <a href="https://github.com/math4720-s26/website" title="GitHub organization" class="quarto-navigation-tool px-1" aria-label="GitHub organization"><i class="bi bi-github"></i></a>
    <a href="https://d2l.mu.edu/d2l/home/630388" title="D2L" class="quarto-navigation-tool px-1" aria-label="D2L"><i class="bi bi-person-fill"></i></a>
</div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">Course Information</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../course-overview.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Overview</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Schedule</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../course-syllabus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Syllabus</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../course-hours.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Help Desk Hours</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../hw.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Homework</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ws.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Worksheet</span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        
    <div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="15-regression-slides.html"><i class="bi bi-file-slides"></i>RevealJS (live)</a></li></ul></div></div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title">Regression <svg aria-hidden="true" role="img" viewbox="0 0 640 512" style="height:1em;width:1.25em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M64 64a64 64 0 1 1 128 0A64 64 0 1 1 64 64zM25.9 233.4C29.3 191.9 64 160 105.6 160h44.8c27 0 51 13.4 65.5 34.1c-2.7 1.9-5.2 4-7.5 6.3l-64 64c-21.9 21.9-21.9 57.3 0 79.2L192 391.2V464c0 26.5-21.5 48-48 48H112c-26.5 0-48-21.5-48-48V348.3c-26.5-9.5-44.7-35.8-42.2-65.6l4.1-49.3zM448 64a64 64 0 1 1 128 0A64 64 0 1 1 448 64zM431.6 200.4c-2.3-2.3-4.9-4.4-7.5-6.3c14.5-20.7 38.6-34.1 65.5-34.1h44.8c41.6 0 76.3 31.9 79.7 73.4l4.1 49.3c2.5 29.8-15.7 56.1-42.2 65.6V464c0 26.5-21.5 48-48 48H496c-26.5 0-48-21.5-48-48V391.2l47.6-47.6c21.9-21.9 21.9-57.3 0-79.2l-64-64zM272 240v32h96V240c0-9.7 5.8-18.5 14.8-22.2s19.3-1.7 26.2 5.2l64 64c9.4 9.4 9.4 24.6 0 33.9l-64 64c-6.9 6.9-17.2 8.9-26.2 5.2s-14.8-12.5-14.8-22.2V336H272v32c0 9.7-5.8 18.5-14.8 22.2s-19.3 1.7-26.2-5.2l-64-64c-9.4-9.4-9.4-24.6 0-33.9l64-64c6.9-6.9 17.2-8.9 26.2-5.2s14.8 12.5 14.8 22.2z"></path></svg>
</h1>
<p class="subtitle lead">MATH 4720/MSSC 5720 Introduction to Statistics</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Dr.&nbsp;Cheng-Han Yu <br> Department of Mathematical and Statistical Sciences <br> Marquette University </p>
          </div>
  </div>
    
  
    
  </div>
  


</header><section id="section" class="level1" data-visibility="hidden"><h1 data-visibility="hidden"></h1>
<!-- begin: webr fodder -->
<!-- end: webr fodder -->
<!-- # [Hypothesis Testing]{.orange}{background-image="https://upload.wikimedia.org/wikipedia/commons/4/42/William_Sealy_Gosset.jpg" background-size="cover" background-position="50% 50%" background-color="#447099"} -->
</section><section id="regression" class="level1" data-background-image="./images/15-regression/correlation_diagram_1875.jpg" data-background-size="cover" data-background-position="50% 50%" data-background-color="#447099"><h1 data-background-image="./images/15-regression/correlation_diagram_1875.jpg" data-background-size="cover" data-background-position="50% 50%" data-background-color="#447099"><span class="orange">Regression</span></h1>
<section id="what-is-regression" class="level2"><h2 class="anchored" data-anchor-id="what-is-regression">What is Regression</h2>
<ul>
<li><p><strong>Regression</strong> models the relationship between one or more <strong>numerical/categorical response variables <span class="math inline">\((Y)\)</span></strong> and one or more <strong>numerical/categorical explanatory variables <span class="math inline">\((X)\)</span></strong>.</p></li>
<li><p>A <strong>regression function</strong> <span class="math inline">\(f(X)\)</span> describes how a response variable <span class="math inline">\(Y\)</span>, on average, changes as an explanatory variable <span class="math inline">\(X\)</span> changes.</p></li>
</ul>
<div class="columns">
<div class="column" style="width:50%;">
<p>Examples:</p>
<ul>
<li><p><span style="color:blue"> college GPA <span class="math inline">\((Y)\)</span> vs.&nbsp;ACT/SAT score <span class="math inline">\((X)\)</span></span></p></li>
<li><p><span style="color:blue"> sales <span class="math inline">\((Y)\)</span> vs.&nbsp;advertising expenditure <span class="math inline">\((X)\)</span></span></p></li>
<li><p><span style="color:blue"> crime rate <span class="math inline">\((Y)\)</span> vs.&nbsp;median income level <span class="math inline">\((X)\)</span> </span></p></li>
</ul>
</div><div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="15-regression_files/figure-revealjs/unnamed-chunk-3-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<div class="notes">
<ul>
<li>
<strong>Regression</strong> models the relationship between a numerical <strong>response variable</strong> (dependent variable) and one or more (numerical/categorical) <strong>explanatory variables</strong> (independent variables, predictors, or covariates).</li>
<li>A <strong>regression function</strong> describes how a response variable <span class="math inline">\(Y\)</span> changes as an explanatory variable <span class="math inline">\(X\)</span> changes.</li>
<li>The true relationship between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>, the regression function, is <strong>unknown</strong>.</li>
<li>The goal of regression is to estimate the regression function and use it to <strong>predict</strong> value of <span class="math inline">\(Y\)</span> given a value of <span class="math inline">\(X\)</span>.</li>
<li>Examples:
<ul>
<li><span style="color:blue"> Relationship between college GPA (<span class="math inline">\(Y\)</span>) and ACT/SAT scores (<span class="math inline">\(X\)</span>)</span></li>
<li><span style="color:blue"> Relationship between sales (<span class="math inline">\(Y\)</span>) and advertising expenditure (<span class="math inline">\(X\)</span>)</span></li>
<li><span style="color:blue"> Relationship between crime rate (<span class="math inline">\(Y\)</span>) and median income level (<span class="math inline">\(X\)</span>) </span></li>
</ul>
</li>
</ul>
</div>
</section><section id="unknown-regression-function" class="level2"><h2 class="anchored" data-anchor-id="unknown-regression-function">Unknown Regression Function</h2>
<ul>
<li><p>The true relationship between <span class="math inline">\(X\)</span> and the mean of <span class="math inline">\(Y\)</span>, the regression function <span class="math inline">\(f(X)\)</span>, is <strong>unknown</strong>.</p></li>
<li><p>The collected data <span class="math inline">\((x_1, y_1), (x_2, y_2), \dots, (x_n, y_n)\)</span> is all we know and have.</p></li>
<li><p>Goal: <strong>estimate</strong> <span class="math inline">\(f(X)\)</span> from our data and use it to <strong>predict</strong> value of <span class="math inline">\(Y\)</span> given any value of <span class="math inline">\(X\)</span>.</p></li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="15-regression_files/figure-revealjs/unnamed-chunk-4-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section><section id="simple-linear-regression" class="level2"><h2 class="anchored" data-anchor-id="simple-linear-regression">Simple Linear Regression</h2>
<ul>
<li>Start with <strong>simple linear regression</strong>:
<ul>
<li>
<strong>Only one</strong> predictor <span class="math inline">\(X\)</span> (<strong>known</strong> and <strong>constant</strong>) and <strong>one</strong> response variable <span class="math inline">\(Y\)</span>
</li>
<li>the regression function used for predicting <span class="math inline">\(Y\)</span> is a <strong>linear</strong> function.</li>
<li>use a <em>regression line</em> in a X-Y plane to predict the value of <span class="math inline">\(Y\)</span> for a given value of <span class="math inline">\(X = x\)</span>.</li>
</ul>
</li>
</ul>
<!-- - Suppose that $Y$ is a response variable (plotted on the vertical axis) and $X$ is an explanatory variable (plotted on the horizontal axis). A straight line relating $Y$ to $X$ has an equation of the form --><!-- $$ Y = b_0 + b_1X$$ --><p>. . .</p>
<div class="columns">
<div class="column" style="width:50%;">
<p><strong>Math review</strong>: A linear function <span class="math inline">\(y = f(x) = \beta_0 + \beta_1 x\)</span> represents a straight line</p>
<ul>
<li><p><span class="math inline">\(\beta_1\)</span>: <strong>slope</strong>, the amount by which <span class="math inline">\(y\)</span> changes when <span class="math inline">\(x\)</span> increases by one unit.</p></li>
<li><p><span class="math inline">\(\beta_0\)</span>: <strong>intercept</strong>, the value of <span class="math inline">\(y\)</span> when <span class="math inline">\(x = 0\)</span>.</p></li>
<li><p>The linearity assumption: <span class="math inline">\(\beta_1\)</span> does not change as <span class="math inline">\(x\)</span> changes.</p></li>
</ul>
</div><div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="./images/15-regression/reg_line.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<div class="notes">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="15-regression_files/figure-revealjs/unnamed-chunk-6-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</section><section id="sample-data-relationship-between-x-and-y" class="level2"><h2 class="anchored" data-anchor-id="sample-data-relationship-between-x-and-y">Sample Data: Relationship Between X and Y</h2>
<ul>
<li><p>Real data <span class="math inline">\((x_i, y_i), i = 1, 2, \dots, n\)</span> do not form a perfect straight line!</p></li>
<li><p><span class="math inline">\(y_i = \beta_0+\beta_1x_i + \color{red}{\epsilon_i}\)</span></p></li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="15-regression_files/figure-revealjs/unnamed-chunk-7-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section><section id="section-1" class="level2"><h2 class="anchored" data-anchor-id="section-1"></h2>
<ul>
<li><p>When we collect our data, at any given level of <span class="math inline">\(X = x\)</span>, <span class="math inline">\(y\)</span> is assumed being drawn from a normal distribution (for inference purpose).</p></li>
<li><p>Its value varies around and will not be exactly equal to its mean <span class="math inline">\(\mu_y\)</span>.</p></li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="./images/15-regression/regression_line_data.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section><section id="section-2" class="level2"><h2 class="anchored" data-anchor-id="section-2"></h2>
<ul>
<li><p>When we collect our data, at any given level of <span class="math inline">\(X = x\)</span>, <span class="math inline">\(y\)</span> is assumed being drawn from a normal distribution (for inference purpose).</p></li>
<li><p>Its value varies around and will not be exactly equal to its mean <span class="math inline">\(\mu_y\)</span>.</p></li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="./images/15-regression/regression_line_data_blue.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section><section id="section-3" class="level2"><h2 class="anchored" data-anchor-id="section-3"></h2>
<ul>
<li>The <strong>mean of <span class="math inline">\(Y\)</span></strong> and <span class="math inline">\(X\)</span> form a straight line.</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="./images/15-regression/regression_line.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section><section id="simple-linear-regression-model-population" class="level2"><h2 class="anchored" data-anchor-id="simple-linear-regression-model-population">Simple Linear Regression Model (Population)</h2>
<p>For the <span class="math inline">\(i\)</span>-th measurement in the target population,</p>
<p><span class="math display">\[Y_i = \beta_0 + \beta_1X_i + \epsilon_i\]</span></p>
<ul>
<li><p><span class="math inline">\(Y_i\)</span>: the <span class="math inline">\(i\)</span>-th value of the response (random) variable.</p></li>
<li><p><span class="math inline">\(X_i\)</span>: the <span class="math inline">\(i\)</span>-th <strong>known fixed</strong> value of the predictor.</p></li>
<li><p><span class="math inline">\(\epsilon_i\)</span>: the <span class="math inline">\(i\)</span>-th random error with assumption <span class="math inline">\(\epsilon_i \stackrel{iid}{\sim} N(0, \sigma^2)\)</span>.</p></li>
<li><p><span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> are model <strong>coefficients</strong>.</p></li>
<li><p><span class="math inline">\(\beta_0\)</span>, <span class="math inline">\(\beta_1\)</span> and <span class="math inline">\(\sigma^2\)</span> are <strong>fixed unknown parameters</strong> to be estimated from the sample data once we collect them.</p></li>
</ul>
<div class="notes">
<p>.question[ What is the distribution of <span class="math inline">\(Y_i\)</span> given a value of <span class="math inline">\(X = x\)</span>?</p>
</div>
</section><section id="important-features-of-model-y_i-beta_0-beta_1x_i-epsilon_i" class="level2"><h2 class="anchored" data-anchor-id="important-features-of-model-y_i-beta_0-beta_1x_i-epsilon_i">Important Features of Model <span class="math inline">\(Y_i = \beta_0 + \beta_1X_i + \epsilon_i\)</span>
</h2>
<div class="columns">
<div class="column" style="width:40%;">
<p><span class="math inline">\(\epsilon_i \stackrel{iid}{\sim} N(0, \sigma^2)\)</span> <!-- \begin{align*} --> <!-- \mu_{Y_i \mid X_i} &= E(\beta_0 + \beta_1X_i + \epsilon_i) \\ --> <!-- &= \beta_0 + \beta_1X_i --> <!-- \end{align*} --></p>
<p><span class="math display">\[\begin{align*}
\mu_{Y_i \mid X_i} = \beta_0 + \beta_1X_i
\end{align*}\]</span></p>
<p>The <strong>mean response</strong> <span class="math inline">\(\mu_{Y\mid X}\)</span> has a <strong>straight-line</strong> relationship with <span class="math inline">\(X\)</span> given by a population regression line <span class="math display">\[\mu_{Y\mid X} = \beta_0 + \beta_1X\]</span></p>
</div><div class="column" style="width:60%;">
<!-- - The mean of $Y$ is a linear function of $X$ -->
<!-- - The variance of $Y$ does not depend on $X$. -->
<!-- - If the simple linear model is appropriate, then we need to estimate the values $\beta_0$, $\beta_1$ and $\sigma^2$. -->
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="./images/15-regression/regression_line_red.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section><section id="important-features-of-model-y_i-beta_0-beta_1x_i-epsilon_i-1" class="level2"><h2 class="anchored" data-anchor-id="important-features-of-model-y_i-beta_0-beta_1x_i-epsilon_i-1">Important Features of Model <span class="math inline">\(Y_i = \beta_0 + \beta_1X_i + \epsilon_i\)</span>
</h2>
<div class="columns">
<div class="column" style="width:40%;">
<p><span class="math inline">\(\epsilon_i \stackrel{iid}{\sim} N(0, \sigma^2)\)</span> <span class="math display">\[\begin{align*}
\mathrm{Var}(Y_i \mid X_i) &amp;= \mathrm{Var}(\epsilon_i) = \sigma^2
\end{align*}\]</span> The variance of <span class="math inline">\(Y\)</span> does not depend on <span class="math inline">\(X\)</span>.</p>
</div>
<!-- - The mean of $Y$ is a linear function of $X$ --><!-- - The variance of $Y$ does not depend on $X$. --><!-- - If the simple linear model is appropriate, then we need to estimate the values $\beta_0$, $\beta_1$ and $\sigma^2$. --><div class="column" style="width:60%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="./images/15-regression/regression_line_sig.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<div class="notes">
<ul>
<li>The variation of Y is the same no matter what value of x is.</li>
</ul>
</div>
</section><section id="important-features-of-model-y_i-beta_0-beta_1x_i-epsilon_i-2" class="level2"><h2 class="anchored" data-anchor-id="important-features-of-model-y_i-beta_0-beta_1x_i-epsilon_i-2">Important Features of Model <span class="math inline">\(Y_i = \beta_0 + \beta_1X_i + \epsilon_i\)</span>
</h2>
<div class="columns">
<div class="column" style="width:40%;">
<p><span class="math inline">\(\epsilon_i \stackrel{iid}{\sim} N(0, \sigma^2)\)</span> <span class="math display">\[\begin{align*}
Y_i \mid X_i \stackrel{indep}{\sim} N(\beta_0 + \beta_1X_i, \sigma^2)
\end{align*}\]</span> For any fixed value of <span class="math inline">\(X_i = x_i\)</span>, the response <span class="math inline">\(Y_i\)</span> varies with <span class="math inline">\(N(\mu_{Y_i\mid x_i}, \sigma^2)\)</span>.</p>
</div>
<!-- - The mean of $Y$ is a linear function of $X$ --><!-- - The variance of $Y$ does not depend on $X$. --><!-- - If the simple linear model is appropriate, then we need to estimate the values $\beta_0$, $\beta_1$ and $\sigma^2$. --><div class="column" style="width:60%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="./images/15-regression/regression_line_sig_red.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<p>. . .</p>
<ul>
<li>
<strong>Job</strong>: Collect data and estimate the unknown parameters <span class="math inline">\(\beta_0\)</span>, <span class="math inline">\(\beta_1\)</span> and <span class="math inline">\(\sigma^2\)</span>!</li>
</ul></section><section id="idea-of-fitting" class="level2"><h2 class="anchored" data-anchor-id="idea-of-fitting">Idea of Fitting</h2>
<ul>
<li>Interested in <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> in the following <em>sample</em> regression model: <span class="math display">\[\begin{align*}
y_i = \beta_0 + \beta_1~x_{i} + \epsilon_i,
\end{align*}\]</span> <!-- or --> <!-- $$E({y}_{i}) = \mu_{y|x_i} = \beta_0 + \beta_1~x_{i}$$ -->
</li>
</ul>
<div class="notes">
<ul>
<li>OK. once we collect the data, we have a sample regression model.</li>
<li>Here I use small x and y to represent the collected data.</li>
<li>Given this model, we’re interested in <span class="math inline">\(\beta_0\)</span> (population parameter for the intercept) and <span class="math inline">\(\beta_1\)</span> (population parameter for the slope) because once we know <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>, we know the exact shape of <span class="math inline">\(f\)</span> and we know the relationship of <span class="math inline">\(y\)</span> and <span class="math inline">\(x\)</span>, and given any value of <span class="math inline">\(x\)</span>, we can predict its corresponding value of <span class="math inline">\(y\)</span> using the regression line <span class="math inline">\(\hat{y}_{i} = \beta_0 + \beta_1~x_{i}\)</span>.</li>
<li>But again the population parameters are unknown to us.</li>
<li><span class="math inline">\(\hat{y}_i = E(Y|X_i=x_i)\)</span></li>
</ul>
</div>
<p>. . .</p>
<ul>
<li><p>Use sample statistics <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span> computed from our sample data to estimate <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>.</p></li>
<li><p><span class="math inline">\(\hat{y}_{i} = b_0 + b_1~x_{i}\)</span> is called <strong>fitted value</strong> of <span class="math inline">\(y_i\)</span>, a point estimate of the mean <span class="math inline">\(\mu_{y|x_i}\)</span> and <span class="math inline">\(y_i\)</span> itself.</p></li>
</ul>
<div class="notes">
<ul>
<li>
<span class="math inline">\(b_0\)</span>: intercept of the sample regression line</li>
<li>
<span class="math inline">\(b_1\)</span>: slope of the sample regression line</li>
</ul>
</div>
</section><section id="fitting-a-regression-line-haty-b_0-b_1x" class="level2"><h2 class="anchored" data-anchor-id="fitting-a-regression-line-haty-b_0-b_1x">Fitting a Regression Line <span class="math inline">\(\hat{Y} = b_0 + b_1X\)</span>
</h2>
<p>Given the sample data <span class="math inline">\(\{ (x_1, y_1), (x_2, y_2), \dots, (x_n, y_n)\},\)</span></p>
<ul>
<li><p>Which <em>sample</em> regression line is the <strong>best</strong>?</p></li>
<li><p>What are the <strong>best</strong> estimators <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span> for <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>?</p></li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="15-regression_files/figure-revealjs/unnamed-chunk-14-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<div class="notes">
<ul>
<li>Now suppose we already get our sample, and now we are trying to use the sample to get a sample regression line, and hopefully, the sample regression line and the population regression line are alike. look similarly.</li>
<li>So people usually ask</li>
<li>Which <em>sample</em> regression line is the <strong>best</strong>?</li>
<li>What are the <strong>best</strong> estimators <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span> for <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>?</li>
<li>After all, given the data, we can generate so many different straight lines, and we need a criterion to help us determine which line is the best in some sense. Right!</li>
</ul>
</div>
</section><section id="fitting-a-regression-line-haty-b_0-b_1x-1" class="level2"><h2 class="anchored" data-anchor-id="fitting-a-regression-line-haty-b_0-b_1x-1">Fitting a Regression Line <span class="math inline">\(\hat{Y} = b_0 + b_1X\)</span>
</h2>
<p>Given the sample data <span class="math inline">\(\{ (x_1, y_1), (x_2, y_2), \dots, (x_n, y_n)\},\)</span></p>
<ul>
<li><p>Which <em>sample</em> regression line is the <strong>best</strong>?</p></li>
<li><p>What are the <strong>best</strong> estimators <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span> for <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>?</p></li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="15-regression_files/figure-revealjs/unnamed-chunk-15-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section><section id="what-does-best-mean-ordinary-least-squares-ols" class="level2"><h2 class="anchored" data-anchor-id="what-does-best-mean-ordinary-least-squares-ols">What does “best” mean? Ordinary Least Squares (OLS)</h2>
<ul>
<li>Choose <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span>, or sample regression line <span class="math inline">\(b_0 + b_1x\)</span> that minimizes the <strong>sum of squared residuals <span class="math inline">\(SS_{res}\)</span></strong>
</li>
</ul>
<p><span class="math display">\[SS_{res} = e_1^2 + e_2^2 + \dots + e_n^2 = \sum_{i = 1}^n e_i^2,\]</span> where the <strong>residual</strong> <span class="math inline">\(e_i = y_i - \hat{y}_i = y_i - (b_0 + b_1x_i)\)</span>.</p>
<!-- is a point estimate of $\epsilon_i$. -->
<!-- - The sample regression line minimizes $SS_{res} = e_1^2 + e_2^2 + \dots + e_n^2 = \sum_{i = 1}^n e_i^2$. -->
<p>. . .</p>
<ul>
<li>If <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span> are the best estimators,</li>
</ul>
<p><span class="math display">\[\small{\begin{align} SS_{res} &amp;= (y_1 - b_0 - b_1x_1)^2 + (y_2 - b_0 - b_1x_2)^2 + \dots + (y_n - b_0 - b_1x_n)^2\\ &amp;= \sum_{i=1}^n(y_i - b_0 - b_1x_i)^2 \end{align}}\]</span> that is the smallest comparing to any other <span class="math inline">\(SS_{res} = \sum_{i=1}^n(y_i - a_0 - a_1x_i)^2\)</span> that uses another pair of values <span class="math inline">\((a_0, a_1) \ne (b_0, b_1)\)</span>.</p>
<div class="notes">
<ul>
<li>Now the question is How do we get <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span> that well estimate <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>?</li>
<li>We choose <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span>, or regression line <span class="math inline">\(b_0 + b_1x\)</span> that minimizes the <strong>sum of squared residuals</strong>.</li>
<li>If we define residual as <span class="math inline">\(e_i = y_i - \hat{y}_i\)</span>, then the sum of squared residuals is <span class="math inline">\(\sum_{i = 1}^n e_i^2\)</span>.</li>
<li>And this approach that estimates the population parameters <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> or the population regression line is called Ordinary Least Squares method.</li>
</ul>
</div>
</section><section id="visualizing-residuals" class="level2"><h2 class="anchored" data-anchor-id="visualizing-residuals">Visualizing Residuals</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="15-regression_files/figure-revealjs/unnamed-chunk-16-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<div class="notes">
<p>That’s see the idea of Ordinary Least Squares visually. Here just showed the data. - Later we will work on the data set together. <!-- - Do you see why some points are darker than some others? --> <!-- - A darker point means that there are several identical (x, y) pairs, or replicates in the data set. --></p>
</div>
</section><section id="visualizing-residuals-cont." class="level2"><h2 class="anchored" data-anchor-id="visualizing-residuals-cont.">Visualizing Residuals (cont.)</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="15-regression_files/figure-revealjs/unnamed-chunk-17-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<div class="notes">
<ul>
<li>All right, with the data, this figure also shows the least squares regression line, and the fitted value of <span class="math inline">\(y\)</span> for each <span class="math inline">\(x\)</span> in the training data, which are those red points.</li>
<li>The fitted values of y are right on the regression line.</li>
<li>Now the question is, how do we find this line?</li>
<li>Given a line, we can have predicted values of y, right?</li>
<li>Then what is residual on the plot? The residual will be the difference between the true observation y and the fitted value of y given any value of x.</li>
<li>So a residual in the plot will be a vertical bar at the value of x with two ends of the bar <span class="math inline">\(y\)</span> and <span class="math inline">\(\hat{y}\)</span>, right?</li>
<li>(Show on board)</li>
<li>(add <span class="math inline">\(y_i = b_0+b_1x_i\)</span> and residual line)</li>
</ul>
</div>
</section><section id="visualizing-residuals-cont.-1" class="level2"><h2 class="anchored" data-anchor-id="visualizing-residuals-cont.-1">Visualizing Residuals (cont.)</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="15-regression_files/figure-revealjs/unnamed-chunk-18-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<div class="notes">
<ul>
<li>Here shows all the residuals in vertical bars.</li>
<li>least squares line is the line such that the sum of all the squared residuals is minimized.</li>
<li>Why we square the residuals?</li>
<li>It’s mathematically more convenient.</li>
<li>Squaring emphasizes larger differences</li>
</ul>
</div>
</section><section id="least-squares-estimates-lse" class="level2"><h2 class="anchored" data-anchor-id="least-squares-estimates-lse">Least Squares Estimates (LSE)</h2>
<ul>
<li>The least squares approach choose <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span> to minimize the <span class="math inline">\(SS_{res}\)</span>, i.e.,</li>
</ul>
<p><span class="math display">\[(b_0, b_1) = \arg \min_{\alpha_0, \alpha_1} \sum_{i=1}^n(y_i - \alpha_0 - \alpha_1x_i)^2\]</span> <!-- - Take derivative with respect to $\beta_0$ and $\beta_1$, setting both equal to zero: --> <!-- $$\left.\frac{\partial SS_{res}}{\partial\beta_0}\right\vert_{b_0, b_1} = \left.\sum_{i=1}^n\frac{\partial (y_i - \beta_0 - \beta_1x_i)^2}{\partial\beta_0}\right\vert_{b_0, b_1} = 0$$ --> <!-- $$\left. \frac{\partial SS_{res}}{\partial\beta_1}\right\vert_{b_0, b_1} = \left.\sum_{i=1}^n\frac{\partial (y_i - \beta_0 - \beta_1x_i)^2}{\partial\beta_1}\right\vert_{b_0, b_1} = 0$$ --></p>
<!-- The two equations are called the **normal equations**. -->
<p>. . .</p>
<p>MATH 1450/1455 …</p>
<p><span class="math display">\[\color{red}{b_0 = \overline{y} - b_1\overline{x}}\]</span> <!-- - Solve for $\beta_1$ given $\color{red}{b_0 = \overline{y} - b_1\overline{x}}$: --> <!-- $$\sum_{i=1}^nx_iy_i - (\overline{y} - b_1\overline{x})n\overline{x} - b_1\sum_{i=1}^nx_i^2 = 0.$$ Then--></p>
<p><span class="math display">\[\color{red}{b_1 = \frac{\sum_{i=1}^n(x_i - \overline{x})(y_i - \overline{y})}{\sum_{i=1}^n(x_i - \overline{x})^2} = r \frac{\sqrt{S_{yy}}}{\sqrt{S_{xx}}}},\]</span> where <span class="math inline">\(S_{xx} = \sum_{i=1}^n(x_i - \overline{x})^2\)</span> and <span class="math inline">\(S_{yy} = \sum_{i=1}^n(y_i - \overline{y})^2\)</span></p>
<p>. . .</p>
<div class="question">
<p>What can we learn from the formula of <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span>?</p>
</div>
<div class="notes">
<ul>
<li>The LS regression line passes through the centroid.</li>
<li>
<span class="math inline">\(b_1\)</span> is kinda like a scaled covariance of X and Y.</li>
</ul>
</div>
<!-- ## Population Model vs. Estimated Model -->
<!-- {{< include model-reg-ojs.qmd >}} -->
</section><section id="r-lab-mpg-data" class="level2"><h2 class="anchored" data-anchor-id="r-lab-mpg-data">
<span class="pink">R Lab</span>: <code>mpg</code> Data</h2>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>  <span class="co">## use data mpg in ggplot2 package</span></span>
<span><span class="va">mpg</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre class="my_class600"><code># A tibble: 234 × 11
   manufacturer model      displ  year   cyl trans drv     cty   hwy fl    class
   &lt;chr&gt;        &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;
 1 audi         a4           1.8  1999     4 auto… f        18    29 p     comp…
 2 audi         a4           1.8  1999     4 manu… f        21    29 p     comp…
 3 audi         a4           2    2008     4 manu… f        20    31 p     comp…
 4 audi         a4           2    2008     4 auto… f        21    30 p     comp…
 5 audi         a4           2.8  1999     6 auto… f        16    26 p     comp…
 6 audi         a4           2.8  1999     6 manu… f        18    26 p     comp…
 7 audi         a4           3.1  2008     6 auto… f        18    27 p     comp…
 8 audi         a4 quattro   1.8  1999     4 manu… 4        18    26 p     comp…
 9 audi         a4 quattro   1.8  1999     4 auto… 4        16    25 p     comp…
10 audi         a4 quattro   2    2008     4 manu… 4        20    28 p     comp…
# ℹ 224 more rows</code></pre>
</div>
</div>
</section><section id="r-lab-highway-mpg-hwy-vs.-displacement-displ" class="level2"><h2 class="anchored" data-anchor-id="r-lab-highway-mpg-hwy-vs.-displacement-displ">
<span class="pink">R Lab</span>: Highway MPG <code>hwy</code> vs.&nbsp;Displacement <code>displ</code>
</h2>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">mpg</span><span class="op">$</span><span class="va">displ</span>, y <span class="op">=</span> <span class="va">mpg</span><span class="op">$</span><span class="va">hwy</span>,</span>
<span>     las <span class="op">=</span> <span class="fl">1</span>, pch <span class="op">=</span> <span class="fl">19</span>, col <span class="op">=</span> <span class="st">"navy"</span>, cex <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Displacement (litres)"</span>, ylab <span class="op">=</span> <span class="st">"Highway MPG"</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Highway MPG vs. Engine Displacement (litres)"</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="15-regression_files/figure-revealjs/unnamed-chunk-20-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<div class="notes">
<ul>
<li>Usually, when we get data, the first thing is plotting your data, doing some exploratory data analysis, and see if there is useful information out there that may help us build an appropriate model.</li>
<li>To make a scatter plot, we can simply use the plot() function, and put displ in x axis and hwy in the y axis.</li>
<li>To grab a variable or a column of a data frame, we can use the dollar sign, the same way as a list extracting an element.</li>
<li>The rest of arguments are optional, they are just used to decorate your plot. You can generate a plot without specifying any of them.</li>
<li>And because it seems to a linear trend downwards. We could fit a simple linear regression to the data. Right</li>
</ul>
</div>
</section><section id="r-lab-fit-simple-linear-regression" class="level2"><h2 class="anchored" data-anchor-id="r-lab-fit-simple-linear-regression">
<span class="pink">R Lab</span>: Fit Simple Linear Regression</h2>
<div class="midi">
<div class="columns">
<div class="column" style="width:40%;">
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">reg_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">hwy</span> <span class="op">~</span> <span class="va">displ</span>, </span>
<span>              data <span class="op">=</span> <span class="va">mpg</span><span class="op">)</span></span>
<span><span class="va">reg_fit</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = hwy ~ displ, data = mpg)

Coefficients:
(Intercept)        displ  
      35.70        -3.53  </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/typeof.html">typeof</a></span><span class="op">(</span><span class="va">reg_fit</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "list"</code></pre>
</div>
</div>
</div><div class="column" style="width:60%;">
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## all elements in reg_fit</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">reg_fit</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "coefficients"  "residuals"     "effects"       "rank"         
 [5] "fitted.values" "assign"        "qr"            "df.residual"  
 [9] "xlevels"       "call"          "terms"         "model"        </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## use $ to extract an element of a list</span></span>
<span><span class="va">reg_fit</span><span class="op">$</span><span class="va">coefficients</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)       displ 
      35.70       -3.53 </code></pre>
</div>
</div>
</div>
</div>
</div>
<p>. . .</p>
<ul>
<li><p><span class="math inline">\(\widehat{hwy}_{i} = b_0 + b_1 \times displ_{i} =  35.7 - 3.5 \times displ_{i}\)</span></p></li>
<li><p><span class="math inline">\(b_1\)</span>: For one unit (litre) increase of the displacement, we expect the highway MPG to be decreased, on average, by 3.5.</p></li>
</ul>
<div class="notes">
<ul>
<li><p>In R, to fit a linear regression model, it cannot be easier.</p></li>
<li><p>We just need to use the command lm(). We put a formula in the function, y ~ x, and let R know which data set you are considering.</p></li>
<li><p>That’s it. And I save the fitted result in an object called reg_fit.</p></li>
<li><p>You can see lm() function returns a list.</p></li>
<li><p>We can grab the coefficient estimates this way.</p></li>
<li><p>So your sample regression line is like this.</p></li>
</ul>
</div>
</section><section id="r-lab-fitted-values-of-y" class="level2"><h2 class="anchored" data-anchor-id="r-lab-fitted-values-of-y">
<span class="pink">R Lab</span> Fitted Values of <span class="math inline">\(y\)</span>
</h2>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## the first 5 observed response value y</span></span>
<span><span class="va">mpg</span><span class="op">$</span><span class="va">hwy</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 29 29 31 30 26</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## the first 5 fitted value y_hat</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">reg_fit</span><span class="op">$</span><span class="va">fitted.values</span>, <span class="fl">5</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>   1    2    3    4    5 
29.3 29.3 28.6 28.6 25.8 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## the first 5 predictor value x</span></span>
<span><span class="va">mpg</span><span class="op">$</span><span class="va">displ</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.8 1.8 2.0 2.0 2.8</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">reg_fit</span><span class="op">$</span><span class="va">fitted.values</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 234</code></pre>
</div>
</div>
</section><section id="r-lab-add-a-regression-line" class="level2"><h2 class="anchored" data-anchor-id="r-lab-add-a-regression-line">
<span class="pink">R Lab</span> Add a Regression Line</h2>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">mpg</span><span class="op">$</span><span class="va">displ</span>, y <span class="op">=</span> <span class="va">mpg</span><span class="op">$</span><span class="va">hwy</span>, las <span class="op">=</span> <span class="fl">1</span>, pch <span class="op">=</span> <span class="fl">19</span>, col <span class="op">=</span> <span class="st">"navy"</span>, cex <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Displacement (litres)"</span>, ylab <span class="op">=</span> <span class="st">"Highway MPG"</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Highway MPG vs. Engine Displacement (litres)"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span><span class="va">reg_fit</span>, col <span class="op">=</span> <span class="st">"#FFCC00"</span>, lwd <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="15-regression_files/figure-revealjs/unnamed-chunk-24-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section><section id="estimation-for-sigma2" class="level2"><h2 class="anchored" data-anchor-id="estimation-for-sigma2">Estimation for <span class="math inline">\(\sigma^2\)</span>
</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li><p>Think of <span class="math inline">\(\sigma^2\)</span> as <strong>variance around the line</strong> or the <strong>mean square (prediction) error</strong>.</p></li>
<li><p>The estimate of <span class="math inline">\(\sigma^2\)</span> is the <strong>mean square residual</strong> <span class="math inline">\(MS_{res}\)</span>:</p></li>
</ul>
<p><span class="math display">\[\hat{\sigma}^2 = MS_{res} = \frac{SS_{res}}{n-2} = \frac{\sum_{i=1}^n(y_i - \hat{y}_i)^2}{n-2}\]</span></p>
<ul>
<li>
<span class="math inline">\(MS_{res}\)</span> is often shown in computer output as <span class="math inline">\(\texttt{MS(Error)}\)</span> or <span class="math inline">\(\texttt{MS(Residual)}\)</span>. <!-- - $E(MS_{res}) = \sigma^2$, i.e., $\hat{\sigma}^2$ is an unbiased estimator for $\sigma^2$. 👍 -->
</li>
</ul>
</div><div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="./images/15-regression/regression_line_data.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<div class="notes">
<ul>
<li>So we are done estimation for <span class="math inline">\(beta\)</span>. Let’s talk about the estimation of <span class="math inline">\(\sigma^2\)</span>.</li>
<li>The estimate of <span class="math inline">\(\sigma^2\)</span>, denoted as <span class="math inline">\(\hat{\sigma}^2\)</span> or <span class="math inline">\(s_{\epsilon}^2\)</span>, based on the sample data is residual sum of squares divided by <span class="math inline">\(n-2\)</span>, the degrees of freedom</li>
<li>It can be shown that <span class="math inline">\(E(SS_{res}) = (n-2)\sigma^2\)</span>. That is, <span class="math inline">\(\hat{\sigma}^2\)</span> is an <em>unbiased</em> estimator for <span class="math inline">\(\sigma^2\)</span>. 👍</li>
</ul>
</div>
</section><section id="r-lab-standard-error-of-regression" class="level2"><h2 class="anchored" data-anchor-id="r-lab-standard-error-of-regression">
<span class="pink">R Lab</span> Standard Error of Regression</h2>
<div class="cell" data-layout-align="center" data-highlight.output="16">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="op">(</span><span class="va">summ_reg_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">reg_fit</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre class="my_classfull"><code>
Call:
lm(formula = hwy ~ displ, data = mpg)

Residuals:
   Min     1Q Median     3Q    Max 
-7.104 -2.165 -0.224  2.059 15.010 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   35.698      0.720    49.5   &lt;2e-16 ***
displ         -3.531      0.195   -18.1   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.84 on 232 degrees of freedom
Multiple R-squared:  0.587, Adjusted R-squared:  0.585 
F-statistic:  329 on 1 and 232 DF,  p-value: &lt;2e-16</code></pre>
</div>
</div>
<div class="notes">
<ul>
<li>How do we get sigma_hat in R?</li>
<li>Well you could grab residuals and df from lm fit result reg_fit, and use the formula to calculate the sigma_hat. sqrt(sum(reg_fit<span class="math inline">\(residuals^2) / reg_fit\)</span>df.residual)</li>
<li>If you want R to do the calculation for you, you can get the summary of the fitted result reg_fit.</li>
<li>Then the sigma hat is right here.</li>
</ul>
</div>
</section><section id="r-lab-standard-error-of-regression-1" class="level2"><h2 class="anchored" data-anchor-id="r-lab-standard-error-of-regression-1">
<span class="pink">R Lab</span> Standard Error of Regression</h2>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># lots of fitted information saved in summary(reg_fit)!</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">summ_reg_fit</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "call"          "terms"         "residuals"     "coefficients" 
 [5] "aliased"       "sigma"         "df"            "r.squared"    
 [9] "adj.r.squared" "fstatistic"    "cov.unscaled" </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># residual standard error (sigma_hat)</span></span>
<span><span class="va">summ_reg_fit</span><span class="op">$</span><span class="va">sigma</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.84</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># from reg_fit</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">reg_fit</span><span class="op">$</span><span class="va">residuals</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">/</span> <span class="va">reg_fit</span><span class="op">$</span><span class="va">df.residual</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.84</code></pre>
</div>
</div>
<div class="notes">
<ul>
<li>Here shows the fitted information saved in summary(reg_fit)</li>
<li>You see sigma is right here. So you just extract that value if you need.</li>
</ul>
</div>
</section><section id="confidence-interval-for-beta_1" class="level2"><h2 class="anchored" data-anchor-id="confidence-interval-for-beta_1">Confidence Interval for <span class="math inline">\(\beta_1\)</span>
</h2>
<ul>
<li><span class="math inline">\(\frac{b_1 - \beta_1}{\sqrt{\hat{\sigma}^2/S_{xx}}} \sim t_{n-2}\)</span></li>
</ul>
<p>. . .</p>
<ul>
<li>
<span class="math inline">\((1-\alpha)100\%\)</span> CI for <span class="math inline">\(\beta_1\)</span> is <span class="math inline">\(b_1 \pm t_{\alpha/2, n-2}\sqrt{\hat{\sigma}^2/S_{xx}}\)</span>
</li>
</ul>
<p>. . .</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html">confint</a></span><span class="op">(</span><span class="va">reg_fit</span>, level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>            2.5 % 97.5 %
(Intercept) 34.28  37.12
displ       -3.91  -3.15</code></pre>
</div>
</div>
<!-- ## Sampling Distribution of $\beta_0$ and $\beta_1$ -->
<!-- {{< include model-reg-beta-ojs.qmd >}} -->
</section><section id="hypothesis-testing-beta_1" class="level2"><h2 class="anchored" data-anchor-id="hypothesis-testing-beta_1">Hypothesis Testing: <span class="math inline">\(\beta_1\)</span>
</h2>
<ul>
<li><p><span style="color:blue"> <span class="math inline">\(H_0: \beta_1 = \beta_1^0 \quad H_1: \beta_1 \ne \beta_1^0\)</span> </span> <!-- - standard error of $b_1$: $se(b_1) = \sqrt{\frac{MS_{res}}{S_{xx}}}$ --></p></li>
<li><p>Test statistic: Under <span class="math inline">\(H_0\)</span>,</p></li>
</ul>
<p><span class="math display">\[t_{test} = \frac{b_1 - \color{red}{\beta_1^0}}{\sqrt{\frac{\hat{\sigma}^2}{S_{xx}}}} \sim t_{n-2}\]</span></p>
<ul>
<li>Reject <span class="math inline">\(H_0\)</span> in favor of <span class="math inline">\(H_1\)</span> if
<ul>
<li><span class="math inline">\(|t_{test}| &gt; t_{\alpha/2, \, n-2}\)</span></li>
<li><span class="math inline">\(\text{p-value} = 2P(t_{n-2} &gt; |t_{test}|) &lt; \alpha\)</span></li>
</ul>
</li>
</ul>
<div class="notes">
<ul>
<li>in addition to estimation, we may be interested in testing.</li>
<li>To do the testing on <span class="math inline">\(\beta_1\)</span>, the testing procedure is basically the same as the procedure for population mean <span class="math inline">\(\mu\)</span> we reviewed last week.</li>
<li>Usually <span class="math inline">\(\beta_1^0 = 0\)</span>, but we may be interested in other values.</li>
<li>good growth <span class="math inline">\(\beta_1 &gt; 2\)</span>
</li>
</ul>
</div>
</section><section id="r-lab-testing-on-beta_0-and-beta_1" class="level2"><h2 class="anchored" data-anchor-id="r-lab-testing-on-beta_0-and-beta_1">
<span class="pink">R Lab</span> Testing on <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>
</h2>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">summ_reg_fit</span><span class="op">$</span><span class="va">coefficients</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Estimate Std. Error t value  Pr(&gt;|t|)
(Intercept)    35.70      0.720    49.6 2.12e-125
displ          -3.53      0.195   -18.2  2.04e-46</code></pre>
</div>
</div>
<ul>
<li>Testing <span class="math inline">\(H_0: \beta_0 = 0\)</span> and <span class="math inline">\(H_0: \beta_1 = 0\)</span>
</li>
</ul></section><section id="interpretation-of-testing-results" class="level2"><h2 class="anchored" data-anchor-id="interpretation-of-testing-results">Interpretation of Testing Results</h2>
<ul>
<li><p><span style="color:blue"> <span class="math inline">\(H_0: \beta_1 = 0 \quad H_1: \beta_1 \ne 0\)</span> </span></p></li>
<li><p><em>Failing to reject <span class="math inline">\(H_0: \beta_1 = 0\)</span></em> implies there is <strong>no linear relationship</strong> between <span class="math inline">\(Y\)</span> and <span class="math inline">\(X\)</span>.</p></li>
</ul>
<div class="notes">
<ul>
<li>So back to the testing on <span class="math inline">\(\beta_1\)</span>.</li>
<li>If we do not reject <span class="math inline">\(H_0\)</span>, it implies there is <strong>no linear relationship</strong> between <span class="math inline">\(Y\)</span> and <span class="math inline">\(X\)</span>. Right? Because <span class="math inline">\(\beta_1\)</span>, the slope of the regression line is pretty much 0.</li>
</ul>
</div>
<p>. . .</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="15-regression_files/figure-revealjs/unnamed-chunk-30-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
<div class="notes">
<ul>
<li>But it actually has two cases. One <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> may have no relationship at all, or they don’t have linear relationship but have another kind of relationship, like quadratic.</li>
<li>So we have to be careful when we interpret the testing result. OK.</li>
</ul>
</div>
<p>. . .</p>
<div class="question">
<p>If we reject <span class="math inline">\(H_0: \beta_1 = 0\)</span>, does it mean <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are linearly related?</p>
</div>
<div class="notes">
<p>We have to be more careful and precise on what we are claiming.</p>
</div>
</section><section id="test-of-significance-of-regression" class="level2"><h2 class="anchored" data-anchor-id="test-of-significance-of-regression">Test of Significance of Regression</h2>
<ul>
<li>
<em>Rejecting <span class="math inline">\(H_0: \beta_1 = 0\)</span></em> could mean
<ul>
<li>the straight-line model is adequate</li>
<li>better results could be obtained with a more complicated model</li>
</ul>
</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="15-regression_files/figure-revealjs/unnamed-chunk-31-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:56.0%"></p>
</figure>
</div>
</div>
</div>
<div class="notes">
<ul>
<li>
<em>Rejecting <span class="math inline">\(H_0: \beta_1 = 0\)</span></em> could mean
<ul>
<li>the straight-line model is adequate</li>
<li>better results could be obtained with a more complicated model even though there is a linear effect of <span class="math inline">\(x\)</span>
</li>
</ul>
</li>
</ul>
</div>
</section></section><section id="analysis-of-variance-anova-approach" class="level1"><h1>Analysis of Variance (ANOVA) Approach</h1>
<div class="notes">
<ul>
<li>Let’s talk about ANOVA, the idea of partitioning the total variability.</li>
</ul>
</div>
<section id="x---y-relationship-explains-some-deviation" class="level2"><h2 class="anchored" data-anchor-id="x---y-relationship-explains-some-deviation">
<span class="math inline">\(X\)</span> - <span class="math inline">\(Y\)</span> Relationship Explains Some Deviation</h2>
<div class="question">
<p>Suppose we only have data <span class="math inline">\(Y\)</span> and have no information about <span class="math inline">\(X\)</span> and relationship between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>. How do we predict a value of <span class="math inline">\(Y\)</span>?</p>
</div>
<div class="notes">
<ul>
<li>For example, suppose we only have MPG information for the sample of cars and have no info about displacement and their relationship. How do we predict a car’s MPG?</li>
</ul>
</div>
<p>. . .</p>
<ul>
<li><p>Our best guess would be <span class="math inline">\(\overline{y}\)</span> if the data have no pattern, i.e., <span class="math inline">\(\hat{y}_i = \overline{y}\)</span>.</p></li>
<li><p>Treat <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> as uncorrelated.</p></li>
<li><p>The (total) deviation from the mean is <span class="math inline">\((y_i - \overline{y})\)</span></p></li>
</ul>
<p>. . .</p>
<ul>
<li><p>If <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are linearly related, fitting a linear regression model helps us predict the value of <span class="math inline">\(Y\)</span> when the value of <span class="math inline">\(X\)</span> is provided.</p></li>
<li><p><span class="math inline">\(\hat{y}_i = b_0 + b_1x_i\)</span> is closer to <span class="math inline">\(y_i\)</span> than <span class="math inline">\(\overline{y}\)</span>.</p></li>
<li><p>The regression model explains some deviation of <span class="math inline">\(y\)</span>.</p></li>
</ul>
<div class="notes">
<ul>
<li>When we have no information about the relationship between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>, to predict a value of <span class="math inline">\(y\)</span> using the same value given any value of <span class="math inline">\(x\)</span>.</li>
<li>When <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are uncorrelated, the regression model is not helping predict <span class="math inline">\(Y\)</span> because <span class="math inline">\(X\)</span> provides no information about <span class="math inline">\(Y\)</span>.</li>
<li>It means <span class="math inline">\(b_1 = 0\)</span> and <span class="math inline">\(\hat{y}_i = \bar{y}\)</span> for all values of <span class="math inline">\(X\)</span>.</li>
<li>The result is the same as the one when we only have data of <span class="math inline">\(Y\)</span>.</li>
<li>This prediction deviation <span class="math inline">\((y_i - \overline{y})\)</span> is generally the biggest deviation we can have when we have no information about how y varies or how y is affected by others.</li>
</ul>
</div>
</section><section id="partition-of-deviation" class="level2"><h2 class="anchored" data-anchor-id="partition-of-deviation">Partition of Deviation</h2>
<ul>
<li><p><strong>Total deviation = Deviation explained by regression + Unexplained deviation</strong></p></li>
<li><p><span class="math inline">\((y_i - \overline{y}) = (\hat{y}_i - \overline{y}) + (y_i - \hat{y}_i)\)</span></p></li>
<li><p><span class="math inline">\((19 - 9) = (13 - 9) + (19 - 13)\)</span></p></li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="./images/15-regression/partition.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<div class="notes">
<ul>
<li><p>If <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are actually linearly related, fitting a linear regression helps us predict the value of <span class="math inline">\(Y\)</span> when the value of <span class="math inline">\(X\)</span> is provided.</p></li>
<li><p>It means that <span class="math inline">\(\hat{y}_i = b_0 + b_1x_i\)</span> is closer to <span class="math inline">\(y_i\)</span> than <span class="math inline">\(\overline{y}\)</span>.</p></li>
<li><p>Intuitively, the regression model explains some deviation of <span class="math inline">\(y\)</span> by the predictor <span class="math inline">\(X\)</span>.</p></li>
<li><p><span class="math inline">\(X\)</span> does contain some useful and valuable information for predicting value of <span class="math inline">\(Y\)</span>.</p></li>
<li><p>So, we can actually Partition the total deviation into two parts.</p></li>
<li><p>Partition of deviation: <strong>Total deviation = Explained deviation by regression + Unexplained deviation</strong></p></li>
<li><p><span class="math inline">\((y_i - \overline{y}) = (\hat{y}_i - \overline{y}) + (y_i - \hat{y}_i)\)</span></p></li>
</ul>
</div>
</section><section id="sum-of-squares-ss" class="level2"><h2 class="anchored" data-anchor-id="sum-of-squares-ss">Sum of Squares (SS)</h2>
<ul>
<li><p><span class="math inline">\(\sum_{i=1}^n(y_i - \overline{y})^2 = \sum_{i=1}^n(\hat{y}_i - \overline{y})^2 + \sum_{i=1}^n(y_i - \hat{y}_i)^2\)</span></p></li>
<li><p><strong>Total SS <span class="math inline">\((SS_T)\)</span> = Regression SS <span class="math inline">\((SS_R)\)</span> + Residual SS <span class="math inline">\((SS_{res})\)</span></strong></p></li>
<li><p><span class="math inline">\(df_T = df_R + df_{res}\)</span></p></li>
<li><p><span class="math inline">\(\color{blue}{(n-1) = 1 +(n-2)}\)</span></p></li>
</ul>
<!-- -- --><!-- + <span style="color:blue"> $df_T = n - 1$</span>: lose 1 df with constraint $\sum_{i=1}^n(y_i - \overline{y}) = 0$ --><!-- + <span style="color:blue"> $df_R = 1$</span>: all $\hat{y}_i$ are on the regression line with 2 dfs (intercept and slope), but with constraint $\sum_{i=1}^n(\hat{y}_i - \overline{y}) = 0$ --><!-- + <span style="color:blue"> $df_{res} = n - 2$</span>: lose 2 dfs because $\beta_0$ and $\beta_1$ are estimated by $b_0$ and $b_1$, which are linear combo of $y_i$ --><div class="notes">
<ul>
<li>Total variability = variability explained by regression + unexplained variability</li>
<li><span class="math inline">\(\sum_{i=1}^n(y_i - \overline{y})^2 = \sum_{i=1}^n(\hat{y}_i - \overline{y})^2 + \sum_{i=1}^n(y_i - \hat{y}_i)^2 + 2\sum_{i=1}^n(\hat{y}_i - \overline{y})(y_i - \hat{y}_i)\)</span></li>
<li>
</li><li>
<span style="color:blue"> <span class="math inline">\(df_T = n - 1\)</span></span>: lose 1 df with constraint <span class="math inline">\(\sum_{i=1}^n(y_i - \overline{y}) = 0\)</span>
</li>
<li>
<span style="color:blue"> <span class="math inline">\(df_R = 1\)</span></span>: all <span class="math inline">\(\hat{y}_i\)</span> are on the regression line with 2 dfs (intercept and slope), but with constraint <span class="math inline">\(\sum_{i=1}^n(\hat{y}_i - \overline{y}) = 0\)</span>
</li>
<li>
<span style="color:blue"> <span class="math inline">\(df_{res} = n - 2\)</span></span>: lose 2 dfs because <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> are estimated by <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span>, which are linear combo of <span class="math inline">\(y_i\)</span>
</li>
<li>degrees of freedom is the equivalent number of values in the calculation of a statistic that are free to vary.</li>
<li>
<span class="math inline">\(SS_R = b_1S_{xy}\)</span> or <span class="math inline">\(SS_{res} = SS_T - b_1S_{xy}\)</span>.</li>
</ul>
</div>
</section><section id="anova-for-testing-significance-of-regression" class="level2"><h2 class="anchored" data-anchor-id="anova-for-testing-significance-of-regression">ANOVA for Testing Significance of Regression</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="./images/15-regression/anova_table.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p>A larger value of <span class="math inline">\(F_{test}\)</span> indicates that regression is significant.</p></li>
<li>
<p>Reject <span class="math inline">\(H_0\)</span> if</p>
<ul>
<li><span class="math inline">\(F_{test} &gt; F_{\alpha, 1, n-2}\)</span></li>
<li>
<span class="math inline">\(\text{p-value} = P(F_{1, n-2} &gt; F_{test}) &lt; \alpha\)</span>.</li>
</ul>
</li>
<li><p>The ANOVA is designed to test <span class="math inline">\(H_0\)</span> that <strong>all</strong> predictors have no value in predicting <span class="math inline">\(y\)</span>.</p></li>
<li><p>In SLR, the <span class="math inline">\(F\)</span>-test of ANOVA gives the same result as a two-sided <span class="math inline">\(t\)</span>-test of <span class="math inline">\(H_0: \beta_1=0\)</span>.</p></li>
</ul>
<div class="notes">
<ul>
<li>ANOVA is used for testing significance of regression.</li>
<li>It is testing if any predictors or regressors have explanatory power for predicting y.</li>
<li>In other words, it is testing if the whole regression model is useful or not.</li>
<li>Here is the ANOVA table.</li>
<li><span class="math inline">\(H_0: \beta_1 = 0\)</span></li>
<li>A larger value of <span class="math inline">\(F_{test}\)</span> indicates that regression is significant.</li>
<li>Reject <span class="math inline">\(H_0\)</span> in favor of <span class="math inline">\(H_1\)</span> if <span class="math inline">\(F_{test} &gt; F_{\alpha, 1, n-2}\)</span> or <span class="math inline">\(\text{p-value} = P(F_{1, n-2} &gt; F_{test}) &lt; \alpha\)</span>.</li>
<li>The ANOVA is designed to test <span class="math inline">\(H_0\)</span> that <strong>all</strong> predictors have no value in predicting <span class="math inline">\(y\)</span>.</li>
<li>In SLR, there is only one predictor, and hence the <span class="math inline">\(F\)</span>-test of ANOVA gives the same result as a two-sided <span class="math inline">\(t\)</span>-test of <span class="math inline">\(H_0: \beta_1=0\)</span>.</li>
</ul>
<!-- -- --><!-- .question[ --><!-- What is the $H_0$ of ANOVA $F$-test if there are $k \ge 2$ predictors? --><!-- ] --><ul>
<li>If we have <span class="math inline">\(k \ge 2\)</span> predictors, the <span class="math inline">\(F\)</span>-test is testing <span class="math inline">\(H_0: \beta_1=\beta_2=\cdots=\beta_k=0\)</span>.</li>
</ul>
</div>
</section><section id="r-lab-anova-table" class="level2"><h2 class="anchored" data-anchor-id="r-lab-anova-table">
<span class="pink">R Lab</span> ANOVA Table</h2>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">reg_fit</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: hwy
           Df Sum Sq Mean Sq F value Pr(&gt;F)    
displ       1   4848    4848     329 &lt;2e-16 ***
Residuals 232   3414      15                   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="./images/15-regression/anova_table.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<div class="notes">
<ul>
<li>For <span class="math inline">\(H_0: \beta_1 = 0\)</span> in SLR, <span class="math inline">\(t_{test}^2 = F_{test}\)</span>.</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>            Estimate Std. Error t value  Pr(&gt;|t|)
(Intercept)    35.70      0.720    49.6 2.12e-125
displ          -3.53      0.195   -18.2  2.04e-46</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 329</code></pre>
</div>
</div>
<ul>
<li>For <span class="math inline">\(H_0: \beta_1 = 0\)</span>, <span class="math inline">\(t_{test}^2 = \left(\frac{b_1}{\sqrt{MS_{res}/S_{xx}}}\right)^2 = \frac{b_1^2S_{xx}}{MS_{res}} = \frac{b_1S_{xy}}{MS_{res}} = \frac{MS_R}{MS_{res}} = F_{test}\)</span>
</li>
</ul>
</div>
</section><section id="coefficient-of-determination" class="level2"><h2 class="anchored" data-anchor-id="coefficient-of-determination">Coefficient of Determination</h2>
<ul>
<li>The <strong>coefficient of determination</strong> <span class="math inline">\((R^2)\)</span> is the proportion of the variation in <span class="math inline">\(y\)</span> that is explained by the regression model:</li>
</ul>
<p><span class="math display">\[R^2 = \frac{SS_R}{SS_T} =\frac{SS_T - SS_{res}}{SS_T} = 1 - \frac{SS_{res}}{SS_T}\]</span></p>
<ul>
<li><p><span class="math inline">\(R^2\)</span> as the proportionate reduction of total variation associated with the use of <span class="math inline">\(X\)</span>.</p></li>
<li><p><strong>(a)</strong> <span class="math inline">\(\hat{y}_i = y_i\)</span> and <span class="math inline">\(\small SS_{res} =  \sum_{i=1}^n(y_i - \hat{y}_i)^2 = 0\)</span>. <strong>(b)</strong> <span class="math inline">\(\hat{y}_i = \overline{y}\)</span> and <span class="math inline">\(\small SS_R = \sum_{i=1}^n(\hat{y}_i - \overline{y})^2  = 0\)</span>.</p></li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="./images/15-regression/r_square.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<div class="notes">
<ul>
<li>
<strong>coefficient of determination</strong> can be used to measure the quality of our regression or the explanatory power of regressors.</li>
<li>Here (a) and (b) are two extreme cases.</li>
<li>In (a), the fitted value = the true observation. So the regression model explains all the variation in <span class="math inline">\(Y\)</span>, and hence <span class="math inline">\(R^2 = 1\)</span>.</li>
<li>In (b), the fitted value = mean of y as if we don’t have information about <span class="math inline">\(x\)</span> or <span class="math inline">\(x\)</span> is totally useless in predicting <span class="math inline">\(Y\)</span>. In this case, the regression model explains no the variation in <span class="math inline">\(Y\)</span>, and all variation remain unexplained. So <span class="math inline">\(R^2 = 0\)</span>.</li>
</ul>
</div>
</section><section id="r-lab-r2" class="level2"><h2 class="anchored" data-anchor-id="r-lab-r2">
<span class="pink">R Lab</span> <span class="math inline">\(R^2\)</span>
</h2>
<div class="midi">
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a>summ_reg_fit</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre class="my_class600"><code>
Call:
lm(formula = hwy ~ displ, data = mpg)

Residuals:
   Min     1Q Median     3Q    Max 
-7.104 -2.165 -0.224  2.059 15.010 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   35.698      0.720    49.5   &lt;2e-16 ***
displ         -3.531      0.195   -18.1   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.84 on 232 degrees of freedom
Multiple R-squared:  0.587, Adjusted R-squared:  0.585 
F-statistic:  329 on 1 and 232 DF,  p-value: &lt;2e-16</code></pre>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">summ_reg_fit</span><span class="op">$</span><span class="va">r.squared</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.587</code></pre>
</div>
</div>
</section></section><section id="prediction" class="level1"><h1>Prediction</h1>
<section id="predicting-the-mean-response" class="level2"><h2 class="anchored" data-anchor-id="predicting-the-mean-response">Predicting the Mean Response</h2>
<div class="columns">
<div class="column" style="width:70%;">
<ul>
<li>With predictor value <span class="math inline">\(x = x_0\)</span>, we want to estimate the mean response <span class="math inline">\(\mu_{y|x_0} = \beta_0 + \beta_1 x_0\)</span>.
<ul>
<li><span style="color:blue"> The <strong>mean</strong> highway MPG <span class="math inline">\(\mu_{y|x_0}\)</span> when displacement is <span class="math inline">\(x = x_0 = 5.5\)</span>. </span></li>
</ul>
</li>
</ul>
</div><div class="column" style="width:30%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="./images/15-regression/regression_line_red.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<p>. . .</p>
<div class="midi">
<ul>
<li>If <span class="math inline">\(x_0\)</span> is <em>within the range of <span class="math inline">\(x\)</span></em>, an <em>unbiased</em> point estimator for <span class="math inline">\(\mu_{y|x_0}\)</span> is</li>
</ul>
<p><span class="math display">\[\hat{\mu}_{y | x_0} = b_0 + b_1 x_0\]</span></p>
</div>
<p>. . .</p>
<div class="midi">
<ul>
<li>The <span class="math inline">\((1-\alpha)100\%\)</span> CI for <span class="math inline">\(\mu_{y|x_0}\)</span> is</li>
</ul>
<p><span class="math display">\[\hat{\mu}_{y | x_0} \pm t_{\alpha/2, n-2} \hat{\sigma}\sqrt{\frac{1}{n} + \frac{(x_0 - \overline{x})^2}{S_{xx}}}\]</span></p>
</div>
<p>. . .</p>
<div class="question">
<p>Does the length of the CI for <span class="math inline">\(\mu_{y|x_0}\)</span> stay the same at any location of <span class="math inline">\(x_0\)</span>?</p>
</div>
<!-- - The sampling distribution of $\hat{\mu}_{y | x_0}$ is -->
<!-- $$N\left( \mu_{y | x_0} = \beta_0 + \beta_1 x_0, \sigma^2\left(\frac{1}{n} + \frac{(x_0 - \overline{x})^2}{S_{xx}} \right) \right)$$ -->
<div class="notes">
<ul>
<li>
<p>With predictor value <span class="math inline">\(x = x_0\)</span>, we want to estimate the mean response <span class="math inline">\(E(y\mid x_0) = \mu_{y|x_0} = \beta_0 + \beta_1 x_0\)</span>.</p>
<ul>
<li><span style="color:blue"> The <strong>mean</strong> highway MPG <span class="math inline">\(E(y \mid x_0)\)</span> when displacement is <span class="math inline">\(x = x_0 = 5.5\)</span>. </span></li>
</ul>
</li>
<li><p>If <span class="math inline">\(x_0\)</span> is <em>within the range of <span class="math inline">\(x\)</span></em>, an <em>unbiased</em> point estimator for <span class="math inline">\(E(y\mid x_0)\)</span> is <span class="math display">\[\widehat{E(y\mid x_0)} = \hat{\mu}_{y | x_0} = b_0 + b_1 x_0\]</span></p></li>
<li><p>The <span class="math inline">\((1-\alpha)100\%\)</span> CI for <span class="math inline">\(E(y\mid x_0)\)</span> is <span class="math inline">\(\boxed{\hat{\mu}_{y | x_0} \pm t_{\alpha/2, n-2} \hat{\sigma}\sqrt{\frac{1}{n} + \frac{(x_0 - \overline{x})^2}{S_{xx}}}}\)</span>. <!-- - Remember there are two types of prediction, predicting the mean response $E(y\mid x_0)$ and predicting an observation value given a value of $x$. --> <!-- - Here, we are doing real prediction, because we are not predicting the observation given the $x$ value in the data set, but we use our data set to do prediction when $x$ is a new value that is not in the data set. --> <!-- - So $x_0$ is any new value that is not shown in the data set. --> <!-- - We are interested in predicting a new mean response or new observation given the new value of $X$. OK. --> <!-- - For a given predictor value $x = x_0$, we want to estimate the mean response $E(y\mid x_0) = \mu_{y|x_0}$.  --> <!--   + <span style="color:blue"> The **mean** highway MPG $E(y \mid x_0)$ when displacement is $x = x_0 = 5.5$. </span> --> <!-- - If $x_0$ is within the range of the sample data on $x$, an unbiased point estimator for $E(y\mid x_0)$ is --> <!-- $$\widehat{E(y\mid x_0)} = \hat{\mu}_{y | x_0} = b_0 + b_1 x_0$$ --> <!-- - The sampling distribution of $\hat{\mu}_{y | x_0}$ is --> <!-- $$N\left( \mu_{y | x_0} = \beta_0 + \beta_1 x_0, \sigma^2\left(\frac{1}{n} + \frac{(x_0 - \overline{x})^2}{S_{xx}} \right) \right)$$ --> <!-- - $\widehat{E(y\mid x_0)} = \hat{\mu}_{y | x_0} = b_0 + b_1 x_0$; $\quad E(y\mid x_0) = \mu_{y | x_0} = \beta_0 + \beta_1 x_0$ --></p></li>
</ul>
</div>
</section><section id="section-4" class="level2"><h2 class="anchored" data-anchor-id="section-4"></h2>
<div class="midi">
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## CI for the mean response</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">reg_fit</span>, newdata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>displ <span class="op">=</span> <span class="fl">5.5</span><span class="op">)</span>, interval <span class="op">=</span> <span class="st">"confidence"</span>, level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>   fit  lwr  upr
1 16.3 15.4 17.2</code></pre>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="15-regression_files/figure-revealjs/unnamed-chunk-42-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section><section id="predicting-new-observations" class="level2"><h2 class="anchored" data-anchor-id="predicting-new-observations">Predicting New Observations</h2>
<ul>
<li>Predict the value of a <em>new observation <span class="math inline">\(y_0\)</span></em> with <span class="math inline">\(x = x_0\)</span>.
<ul>
<li><span style="color:blue"> The <strong>highway MPG of a car</strong> <span class="math inline">\(y_0(x_0)\)</span> when its displacement is <span class="math inline">\(x = x_0 = 5.5\)</span>. </span></li>
</ul>
</li>
</ul>
<p>. . .</p>
<ul>
<li>An <em>unbiased</em> point estimator for <span class="math inline">\(y_0(x_0)\)</span> is</li>
</ul>
<p><span class="math display">\[\hat{y}_0(x_0) = b_0 + b_1 x_0\]</span></p>
<p>. . .</p>
<ul>
<li>The <span class="math inline">\((1-\alpha)100\%\)</span> <strong>prediction interval</strong> (PI) for <span class="math inline">\(y_0(x_0)\)</span> is</li>
</ul>
<p><span class="math display">\[\hat{y}_0 \pm t_{\alpha/2, n-2} \hat{\sigma}\sqrt{{\color{red}{1}}+ \frac{1}{n} + \frac{(x_0 - \overline{x})^2}{S_{xx}}}\]</span></p>
<div class="question">
<p>What is the difference between CI for <span class="math inline">\(\mu_{y | x_0}\)</span> and PI for <span class="math inline">\(y_0(x_0)\)</span>?</p>
</div>
<p>. . .</p>
<ul>
<li>
<em>The PI is wider as it includes the uncertainty about <span class="math inline">\(b_0\)</span>, <span class="math inline">\(b_1\)</span> as well as <span class="math inline">\(y_0\)</span> due to error <span class="math inline">\(\epsilon\)</span></em>.</li>
</ul>
<div class="notes">
<ul>
<li>Predict the value of a new observation <span class="math inline">\(y_0\)</span> corresponding to a specified value of predictor <span class="math inline">\(x = x_0\)</span>.
<ul>
<li><span style="color:blue"> The <strong>highway MPG of a car</strong> <span class="math inline">\(y_0(x_0)\)</span> when its displacement is <span class="math inline">\(x = x_0 = 5.5\)</span>. </span></li>
</ul>
</li>
<li>An unbiased point estimator for <span class="math inline">\(y_0(x_0)\)</span> is <span class="math display">\[\hat{y}_0(x_0) = b_0 + b_1 x_0\]</span> <!-- -- -->
</li>
</ul>
<!-- .question[ --><!-- What is the sampling distribution of $\hat{y}_0$? --><!-- ] --><!-- -- --><!-- - $\hat{y}_0 = b_0 + b_1 x_0 \sim N\left(\beta_0 + \beta_1 x_0, \sigma^2\left(\frac{1}{n} + \frac{(x_0 - \overline{x})^2}{S_{xx}} \right) \right)$ --><!-- -- --><!-- .question[ --><!-- What is the distribution of $y_0 = \beta_0 + \beta_1x_0 + \epsilon$? --><!-- ] --><!-- ??? --><!-- - $y_0(x_0)$ itself is a r.v. --><!-- -- --><!-- - $y_0 \sim N\left(\beta_0 + \beta_1 x_0, \sigma^2 \right)$ --><!-- -- --><!-- .question[ --><!-- What is the distribution of $y_0 - \hat{y}_0$? --><!-- ] -->
</div>
</section><section id="r-lab-prediction" class="level2"><h2 class="anchored" data-anchor-id="r-lab-prediction">
<span class="pink">R Lab</span> Prediction</h2>
<div class="midi">
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## CI for the mean response</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">reg_fit</span>, newdata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>displ <span class="op">=</span> <span class="fl">5.5</span><span class="op">)</span>, interval <span class="op">=</span> <span class="st">"confidence"</span>, level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>   fit  lwr  upr
1 16.3 15.4 17.2</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb45"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## PI for the new observation</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">reg_fit</span>, newdata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>displ <span class="op">=</span> <span class="fl">5.5</span><span class="op">)</span>, interval <span class="op">=</span> <span class="st">"predict"</span>, level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>   fit  lwr  upr
1 16.3 8.67 23.9</code></pre>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="15-regression_files/figure-revealjs/unnamed-chunk-44-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<div class="notes">
<ul>
<li>If I can only use one point or value to predict <span class="math inline">\(y_0\)</span>, the best guess is the predicted value on the regression line.</li>
<li>After all, values around the lines would more likely to be drawn based on our model.</li>
<li>Here you can understand why uncertainty quantification is important.</li>
<li>Yes, we can predict an new observation value, but the prediction quality is gonna be bad because we are predict a random variable, not a constant, and <span class="math inline">\(y_0\)</span> can vary a lot around the regression line.</li>
<li>And prediction interval gives us an idea of how good or how bad our prediction is.</li>
</ul>
</div>
</section><section id="section-5" class="level2"><h2 class="anchored" data-anchor-id="section-5"></h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="15-regression_files/figure-revealjs/unnamed-chunk-45-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<div class="notes">
<ul>
<li>CI is the shortest when <span class="math inline">\(x = \bar{x}\)</span>. (Also PI)</li>
<li>PI length looks the same along with <span class="math inline">\(x\)</span> because the <span class="math inline">\(\sigma^2\)</span> dominates the uncertainty, comparing to the uncertainty about <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span>.</li>
</ul>
</div>


<script type="ojs-module-contents">
eyJjb250ZW50cyI6W119
</script><div id="exercise-loading-indicator" class="exercise-loading-indicator d-none d-flex align-items-center gap-2">
<div id="exercise-loading-status" class="d-flex gap-2">

</div>
<div class="spinner-grow spinner-grow-sm">

</div>
</div>
<script type="vfs-file">
W10=
</script></section></section></main><!-- /main --><script type="ojs-module-contents">
eyJjb250ZW50cyI6W119
</script><script type="module">
if (window.location.protocol === "file:") { alert("The OJS runtime does not work with file:// URLs. Please use a web server to view this document."); }
window._ojs.paths.runtimeToDoc = "../../slides";
window._ojs.paths.runtimeToRoot = "../..";
window._ojs.paths.docToRoot = "..";
window._ojs.selfContained = false;
window._ojs.runtime.interpretFromScriptTags();
</script><script>
  // htmlwidgets need to know to resize themselves when slides are shown/hidden.
  // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
  // slide changes (different for each slide format).
  (function () {
    // dispatch for htmlwidgets
    function fireSlideEnter() {
      const event = window.document.createEvent("Event");
      event.initEvent("slideenter", true, true);
      window.document.dispatchEvent(event);
    }

    function fireSlideChanged(previousSlide, currentSlide) {
      fireSlideEnter();

      // dispatch for shiny
      if (window.jQuery) {
        if (previousSlide) {
          window.jQuery(previousSlide).trigger("hidden");
        }
        if (currentSlide) {
          window.jQuery(currentSlide).trigger("shown");
        }
      }
    }

    // hookup for slidy
    if (window.w3c_slidy) {
      window.w3c_slidy.add_observer(function (slide_num) {
        // slide_num starts at position 1
        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
      });
    }

  })();
</script><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/math4720-s26\.github\.io\/website\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p>© Copyright 2026, Cheng-Han Yu</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions"><ul><li><a href="https://github.com/math4720-s26/website/edit/main/slides/15-regression.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/math4720-s26/website/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>This page is built with ❤️ and <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>


</body></html>