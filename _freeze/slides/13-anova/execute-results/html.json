{
  "hash": "6246208d7dc0a3745a27f79fbd11ccd2",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: 'Analysis of Variance (ANOVA) `<svg aria-hidden=\"true\" role=\"img\" viewBox=\"0 0 640 512\" style=\"height:1em;width:1.25em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;\"><path d=\"M64 64a64 64 0 1 1 128 0A64 64 0 1 1 64 64zM25.9 233.4C29.3 191.9 64 160 105.6 160h44.8c27 0 51 13.4 65.5 34.1c-2.7 1.9-5.2 4-7.5 6.3l-64 64c-21.9 21.9-21.9 57.3 0 79.2L192 391.2V464c0 26.5-21.5 48-48 48H112c-26.5 0-48-21.5-48-48V348.3c-26.5-9.5-44.7-35.8-42.2-65.6l4.1-49.3zM448 64a64 64 0 1 1 128 0A64 64 0 1 1 448 64zM431.6 200.4c-2.3-2.3-4.9-4.4-7.5-6.3c14.5-20.7 38.6-34.1 65.5-34.1h44.8c41.6 0 76.3 31.9 79.7 73.4l4.1 49.3c2.5 29.8-15.7 56.1-42.2 65.6V464c0 26.5-21.5 48-48 48H496c-26.5 0-48-21.5-48-48V391.2l47.6-47.6c21.9-21.9 21.9-57.3 0-79.2l-64-64zM272 240v32h96V240c0-9.7 5.8-18.5 14.8-22.2s19.3-1.7 26.2 5.2l64 64c9.4 9.4 9.4 24.6 0 33.9l-64 64c-6.9 6.9-17.2 8.9-26.2 5.2s-14.8-12.5-14.8-22.2V336H272v32c0 9.7-5.8 18.5-14.8 22.2s-19.3 1.7-26.2-5.2l-64-64c-9.4-9.4-9.4-24.6 0-33.9l64-64c6.9-6.9 17.2-8.9 26.2-5.2s14.8 12.5 14.8 22.2z\"/></svg>`{=html}'\ntitle-slide-attributes:\n  data-background-image: ../images/bg.png\n  # data-background-size: stretch\n  # data-slide-number: none\nformat: \n  live-revealjs: \n    output-file: 13-anova-slides.html\n    # theme: slides.scss\n    code-line-numbers: true\nwebr:\n  cell-options:\n    autorun: false\n  packages:\n    - tidyverse\nknitr:\n  opts_chunk:\n    out-width: 100%\n    echo: false\n---\n\n\n# {visibility=\"hidden\"}\n\n\\def\\bx{\\mathbf{x}}\n\\def\\bg{\\mathbf{g}}\n\\def\\bw{\\mathbf{w}}\n\\def\\bbeta{\\boldsymbol \\beta}\n\\def\\bX{\\mathbf{X}}\n\\def\\by{\\mathbf{y}}\n\\def\\bH{\\mathbf{H}}\n\\def\\bI{\\mathbf{I}}\n\\def\\bS{\\mathbf{S}}\n\\def\\bW{\\mathbf{W}}\n\\def\\T{\\text{T}}\n\\def\\cov{\\mathrm{Cov}}\n\\def\\cor{\\mathrm{Corr}}\n\\def\\var{\\mathrm{Var}}\n\\def\\E{\\mathrm{E}}\n\\def\\bmu{\\boldsymbol \\mu}\n\\DeclareMathOperator*{\\argmin}{arg\\,min}\n\\def\\Trace{\\text{Trace}}\n\n\n\n\n<!-- begin: webr fodder -->\n\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n\n\n<!-- end: webr fodder -->\n\n\n<!-- # [Hypothesis Testing]{.orange}{background-image=\"https://upload.wikimedia.org/wikipedia/commons/4/42/William_Sealy_Gosset.jpg\" background-size=\"cover\" background-position=\"50% 50%\" background-color=\"#447099\"} -->\n\n# One-Way Analysis of Variance (ANOVA)\n\n- ### Rationale\n- ### Procedure\n- ### Examples\n\n\n\n\n# [ANOVA Rationale]{.orange}{background-image=\"./images/13-anova/fisher_anova_quote.jpg\" background-size=\"cover\" background-position=\"50% 50%\" background-color=\"#447099\"}\n\n\n\n## Comparing More Than Two Population Means\n\nIn many research settings, we'd like to compare **3 or more** population means.\n\n:::: columns\n\n::: {.column width=\"50%\"}\n\n- <span style=\"color:blue\"> 4 types of devices used to determine the pH of soil samples. </span>\n\n- <span style=\"color:blue\"> Determine whether there are differences in the mean readings of those 4 devices. </span>\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](./images/13-anova/soil.jpeg){fig-align='center' width=100%}\n:::\n:::\n\n\n:::\n\n::: {.column width=\"50%\"}\n\n::: fragment\n\n- <span style=\"color:blue\"> Do different treatments (None, Fertilizer, Irrigation, Fertilizer and Irrigation) affect the mean weights of poplar trees?  </span>\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](./images/13-anova/poplar.jpeg){fig-align='center' width=100%}\n:::\n:::\n\n\n:::\n\n:::\n\n::::\n\n\n::: notes\n\n- In Chapter 6 we learned methods for comparing 2 population means.\n\n:::\n\n\n\n## One-Way Analysis of Variance\n\n- A **factor** is a property or characteristic (categorical variable) that allows us to *distinguish the different populations from one another*.\n\n- **Type of devices** and **treatment of trees** are factors.\n\n- One-way ANOVA examines the effect of a *categorical variable* on the *mean of a numerical variable* (response).\n\n- We use analysis of <span style=\"color:red\"> variance </span> to test the equality of 3 or more population  <span style=\"color:red\"> means</span>. ü§î\n\n- The method is **one-way** because we use one single property (categorical variable) for categorizing the populations.\n\n\n::: notes\n\n- A **treatment** (or **factor**) can be a category or level of a categorical variable.\n\n:::\n\n\n## Requirements of One-Way ANOVA\n\n- The populations of each category are **normally** distributed.\n\n- The populations have the **same variance** $\\sigma^2$ (two-sample pooled $t$-test). \n\n- The samples are **random samples**.\n\n- The samples are **independent** of each other. (not matched or paired in any way)\n\n\n::: notes\n- The method can still work fairly well when the variances are not equal, unless they are differ by large amounts.\n:::\n\n\n## Rationale for ANOVA\n\nData 1 and Data 2 have the same group sample means $\\bar{y}_1$, $\\bar{y}_2$ and $\\bar{y}_3$ denoted as red dots.\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](13-anova_files/figure-revealjs/unnamed-chunk-4-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n::: question\n\nWhich data you are more confident to say the population means $\\mu_1$, $\\mu_2$ and $\\mu_3$ are not all the same?\n\n:::\n\n\n::: notes\n\n- The boxplots clearly show this difference.\n- The 2 data sets have the same group means, but the variance within groups for data 2 is much greater than the variance within groups for data 1.\n- The difference in sample means in Data 1 is more likely due to the true difference in population means.\n- variation between samples is measured by the pairwise distance among the sample means.\n- variation within samples is measured by the how far away the data points away from each other in each sample group.\n\n:::\n\n\n## Variation **Between** Samples & Variation **Within** Samples\n\n- Data 1: Variability between samples is **large** *in comparison to* the variation within samples.\n\n- Data 2: Variation between samples is **small** relatively to the variation within samples.\n\n::: alert\n\nMore confident to conclude there is a difference in population means when variation **between** samples is relatively *larger* than variation **within** samples.\n\n:::\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](./images/13-anova/figure8-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n\n::: notes\n\n=> population means are different.\n\n=> less likely and confident to conclude there is a difference in population means.\n\n- When variation within samples relatively larger than the variation between samples, it's more difficult to distinguish or disentangle one sample from another. \n\n:::\n\n\n\n# [ANOVA Procedures]{.orange}{background-image=\"./images/13-anova/fisher_anova_quote.jpg\" background-size=\"cover\" background-position=\"50% 50%\" background-color=\"#447099\"}\n\n\n## ANOVA Table\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](./images/13-anova/anova_table_k.png){fig-align='center' width=100%}\n:::\n:::\n\n\n## ANOVA Data\n\n- There are 5 populations.\n\n- Within each population, 4 data points are collected.\n\n- Data $y_{ij}$ is the the $j$-th data point in the $i$-th group.\n\n\n| **Population** | **Data**                                               | **Sample Mean**          | **Population Mean**          |\n|:--------------:|:----------------------------------------------------:|:------------------:|:-----------------------:|\n| 1              | $y_{11}$ $\\quad$ $y_{12}$ $\\quad$ $y_{13}$ $\\quad$ $y_{14}$            | $\\bar{y}_{1}$  |$\\mu_{1}$  |\n| 2              | $y_{21}$ $\\quad$ $y_{22}$ $\\quad$ $y_{23}$ $\\quad$ $y_{24}$            | $\\bar{y}_{2}$  |$\\mu_{2}$  |\n| 3              | $y_{31}$ $\\quad$ $y_{32}$ $\\quad$ $y_{33}$ $\\quad$ $y_{34}$            | $\\bar{y}_{3}$  |$\\mu_{3}$  |\n| 4              | $y_{41}$ $\\quad$ $y_{42}$ $\\quad$ $y_{43}$ $\\quad$ $y_{44}$            | $\\bar{y}_{4}$  |$\\mu_{4}$  |\n| 5              | $y_{51}$ $\\quad$ $y_{52}$ $\\quad$ $y_{53}$ $\\quad$ $y_{54}$            | $\\bar{y}_{5}$  |$\\mu_{5}$  |\n\n. . .\n\n::: alert\n\nThis is NOT a tidy data matrix. We may need to save the data in another format before we do ANOVA.\n\n:::\n\n## Procedure of ANOVA\n\n- <span style=\"color:blue\"> $\\begin{align} &H_0: \\mu_1 = \\mu_2 = \\cdots = \\mu_k\\\\  &H_1: \\text{Population means are not all equal} \\end{align}$ </span>\n\n<!-- - We use $F$-test.  -->\n\n- Statistician [Ronald Fisher](https://en.wikipedia.org/wiki/Ronald_Fisher) found a way to define a variable that follows the $F$ distribution:\n\n$$\\frac{\\text{variance between samples}}{\\text{variance within samples}} \\sim F_{df_B,\\, df_W}$$\n\n- If variance *between* samples is larger than variance *within* samples, i.e., $F_{test}$ is much greater than 1, as Data 1, we reject $H_0$.\n\n::: alert\n\nKey: Define variance between samples and variance within samples so that the ratio is $F$ distributed.\n\n:::\n\n\n::: notes\n\nHow do we convert the rationale into a formal testing procedure for the test \n\n:::\n\n\n\n## Variance **Within** Samples\n\n- Back to two-sample pooled $t$-test with equal variance $\\sigma^2$:\n\n$$s_p^2 = \\frac{(n_1-1)s_1^2 + (n_2-1)s_2^2}{n_1 + n_2 - 2}$$\n\n::: question\n\nWhat if general $k$ samples?\n\n:::\n\n. . .\n\n- ANOVA assumes the populations have the **same variance** $\\sigma_1^2 = \\sigma_2^2 = \\cdots = \\sigma_k^2 = \\sigma^2$.\n\n$$\\boxed{s_W^2 = \\frac{(n_1-1)s_1^2 + (n_2-1)s_2^2 + \\cdots + (n_k-1)s_k^2}{n_1 + n_2 + \\cdots + n_k - k}}$$\nwhere $s_i^2$, $i = 1, \\dots ,k$, is the sample variance of group $i$.\n\n- $s_W^2$ represents a *combined* estimate of the common variance $\\sigma^2$. It measures variability of the observations within the $k$ populations.\n\n\n\n::: notes\n\n$s_i^2 = \\frac{\\sum_{j=1}^{n_i}\\left(y_{ij} - \\bar{y}_{i\\cdot}\\right)^2}{n_i-1}$\n\n:::\n\n## Variance **Between** Samples\n\n$$\\boxed{s^2_{B} = \\frac{\\sum_{i=1}^k n_i (\\bar{y}_{i} - \\bar{y}_{})^2}{k-1}}$$ \n\n- $\\bar{y}_{i}$ is the $i$-th sample mean.\n\n- $\\bar{y}_{}$ is the *grand* sample mean with **all** data points in **all** groups combined.\n\n. . .\n\n- $s^2_{B}$ is also an estimate of $\\sigma^2$ and measures variability *among* sample means for the $k$ groups.\n\n- If $H_0$ is true $(\\mu_1 = \\cdots = \\mu_k = \\mu)$, any variation in the sample means is due to chance and randomness, and shouldn't be too large.\n  + $\\bar{y}_{1}, \\cdots, \\bar{y}_{k}$ should be close each other, and they are close to $\\bar{y}_{}$.\n\n\n::: notes\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](./images/13-anova/var_between_group.jpg){fig-align='center' width=100%}\n:::\n:::\n\n\n:::\n\n## $s_B^2$ and $s_W^2$ as Sum of Squares/Degrees of Freedom\n\n- Variance is defined as $\\frac{\\text{Sum of Squares}}{\\text{Degrees of Freedom}}$, which is also called $\\text{Mean Square (MS)}$\n\n- $s_B^2 = \\frac{\\sum_{i=1}^k n_i (\\bar{y}_{i} - \\bar{y}_{})^2}{k-1} = \\frac{\\text{Sum of Squares Between Samples (SSB)}}{df_B} = MSB$\n\n- $s_W^2 = \\frac{\\sum_{i=1}^{k} (n_i - 1)s_i^2}{n_1 + n_2 + \\cdots + n_k - k} = \\frac{\\text{Sum of Squares Within Samples (SSW)}}{df_W} = MSW$ $(N = n_1 + \\cdots + n_k)$\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](./images/13-anova/anova_table_k.png){fig-align='center' width=100%}\n:::\n:::\n\n\n<!-- ## ANOVA Table: Sum of Squares -->\n\n\n## Sum of Squares Identity\n\n$$\\text{Total Sum of Squares (SST)} = \\sum_{j=1}^{n_i}\\sum_{i=1}^{k} \\left(y_{ij} - \\bar{y}_{}\\right)^2 = SSB + SSW$$\n\n$$df_{T} = df_{B} + df_{W} \\implies N - 1 = (k-1) + (N - k)$$\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](./images/13-anova/anova_table_k.png){fig-align='center' width=100%}\n:::\n:::\n\n\n## {visibility=\"hidden\"}\n\n<!-- ::: midi -->\n\n- **Total Sum of Squares (SST)** measures total variation around $\\bar{y}_{}$ in all of the sample data combined (ignoring the groups):\n\n$$\\scriptsize{\\color{blue}{SST = \\sum_{j=1}^{n_i}\\sum_{i=1}^{k} \\left(y_{ij} - \\bar{y}_{}\\right)^2}}$$\n\n<!-- ::: -->\n\n\n\n<!-- ::: midi -->\n\n- **Sum of Squares Between Samples (SSB)** measures the variation **between** sample means:\n\n$$\\scriptsize{ \\color{blue}{SSB = \\sum_{i=1}^{k}n_i \\left(\\bar{y}_{i} - \\bar{y}_{}\\right)^2}}$$\n<!-- ::: -->\n\n\n<!-- ::: midi -->\n\n- **Sum of Squares Within Samples (SSW)** measures the variation of an value $y_{ij}$ about its sample mean $\\bar{y}_{i}$:\n\n$$\\scriptsize{ \\color{blue}{SSW = \\sum_{i=1}^{k} \\sum_{j=1}^{n_i} \\left(y_{ij} - \\bar{y}_{i}\\right)^2 = \\sum_{i=1}^{k} (n_i - 1)s_i^2}}$$\n\n<!-- ::: -->\n\n\n\n::: notes\n\n- SST: sum of squared deviation from each observation to the overall grand mean\n- SSB: sum of squared deviation from each group mean to the overall grand mean\n- What happens when all group means are equal?\n- SSW: sum of squared deviation from each group value to its group mean\n\n:::\n\n\n\n\n## Sum of Squares Identity {visibility=\"hidden\"}\n\n<!-- - $\\left(y_{ij} - \\bar{y}_{\\cdot\\cdot}\\right) =  \\left(y_{ij} - \\bar{y}_{i\\cdot}\\right) + \\left(\\bar{y}_{i\\cdot} - \\bar{y}_{\\cdot\\cdot}\\right)$ -->\n\n<!-- - $\\sum_{j=1}^{n_i}\\sum_{i=1}^{t} \\left(y_{ij} - \\bar{y}_{\\cdot\\cdot}\\right)^2 = \\sum_{i=1}^{t}n_i \\left(\\bar{y}_{i\\cdot} - \\bar{y}_{\\cdot\\cdot}\\right)^2 + \\sum_{i=1}^{t} \\sum_{j=1}^{n_i}\\left(y_{ij} - \\bar{y}_{i\\cdot}\\right)^2$ -->\n\n- $SST = SSB + SSW$ \n\n- $df_{T} = df_{B} + df_{W} \\implies N - 1 = (k-1) + (N - k)$ $(N = n_1 + \\cdots + n_k)$\n<!-- $\\begin{align} &df_{T} = df_{B} + df_{W} \\\\&n - 1 = (k-1) + (n - k) \\end{align}$ -->\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](./images/13-anova/anova_table_k.png){fig-align='center' width=100%}\n:::\n:::\n\n\n\n## Sum of Squares Identity {visibility=\"hidden\"}\n\n- $\\text{Mean Square (MS)} = \\frac{\\text{sum of squares}}{\\text{degrees of freedom}}$\n\n- $MSB = \\frac{SSB}{k-1} = s^2_{B}$\n\n- $MSW = \\frac{SSW}{N-k} = s^2_{W}$\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](./images/13-anova/anova_table_k.png){fig-align='center' width=100%}\n:::\n:::\n\n\n## Sum of Squares Identity\n\n- $F_{test} = \\frac{MSB}{MSW}$\n\n- Under $H_0$, $\\frac{S^2_{B}}{S_W^2} \\sim F_{k-1, \\, N-k}$\n\n- Reject $H_0$ if \n  + $F_{test} > F_{\\alpha, \\, k - 1,\\, N-k}$\n  + $p$-value $P(F_{k - 1,\\, N-k} > F_{test}) < \\alpha$\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](./images/13-anova/anova_table_k.png){fig-align='center' width=100%}\n:::\n:::\n\n\n\n\n\n# [ANOVA Examples]{.orange}{background-image=\"./images/13-anova/fisher_anova_quote.jpg\" background-size=\"cover\" background-position=\"50% 50%\" background-color=\"#447099\"}\n\n\n\n## Example\n\n- A hypothesis is that a nutrient \"Isoflavones\" varies among three types of food: (1) cereals and snacks, (2) energy bars, and (3) veggie burgers. \n\n::::{.columns}\n:::{.column width=\"32%\"}\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](./images/13-anova/cereal.jpeg){fig-align='center' width=100%}\n:::\n:::\n\n:::\n\n:::{.column width=\"2%\"}\n:::\n\n:::{.column width=\"32%\"}\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](./images/13-anova/energy_bar.png){fig-align='center' width=100%}\n:::\n:::\n\n:::\n\n:::{.column width=\"2%\"}\n:::\n\n:::{.column width=\"32%\"}\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](./images/13-anova/veggie_burger.jpeg){fig-align='center' width=100%}\n:::\n:::\n\n:::\n::::\n\n- A sample of 5 each is taken and the amount of isoflavones is measured.\n\n- Is there a sufficient evidence to conclude that the mean isoflavone levels vary among these food items? $\\alpha = 0.05$.\n\n::: notes\n\nAsk for $H_0$\n\n:::\n\n\n## Example - Data\n<!-- - Cereal and snacks: $n_1 = 5$,  $\\bar{y}_1 = 9.2$, $s_1^2 = 33.7$. -->\n<!-- - Energy bars: $n_2 = 5$, $\\bar{y}_2 = 10.00$, $s_2^2 = 29.0$. -->\n<!-- - Veggie burger: $n_3 = 5$, $\\bar{y}_3 = 13.8$, $s_3^2 = 46.7$. -->\n  \n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n\n::::{.columns}\n\n:::{.column width=\"50%\"}\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-line-numbers=\"false\"}\ndata\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   1  2  3\n1  3 19 25\n2 17 10 15\n3 12  9 12\n4 10  7  9\n5  4  5  8\n```\n\n\n:::\n:::\n\n\nHere columns represent food items and rows are samples.\n\n\n::: question\nSo tell me what is the value of $y_{23}$!\n:::\n\n:::\n\n\n:::{.column width=\"50%\"}\n\n::: fragment\n\nWe prefer data format like\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-line-numbers=\"false\"}\ndata_anova\n```\n\n::: {.cell-output .cell-output-stdout}\n\n``` my_class800\n    y    food\n1   3 cereals\n2  17 cereals\n3  12 cereals\n4  10 cereals\n5   4 cereals\n6  19  energy\n7  10  energy\n8   9  energy\n9   7  energy\n10  5  energy\n11 25  veggie\n12 15  veggie\n13 12  veggie\n14  9  veggie\n15  8  veggie\n```\n\n\n:::\n:::\n\n\n:::\n\n:::\n\n::::\n\n\n::: notes\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output .cell-output-stderr}\n\n```\n‚îÄ‚îÄ Attaching core tidyverse packages ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ tidyverse 2.0.0 ‚îÄ‚îÄ\n‚úî dplyr     1.1.4     ‚úî readr     2.1.5\n‚úî forcats   1.0.0     ‚úî stringr   1.5.1\n‚úî ggplot2   4.0.0     ‚úî tibble    3.3.0\n‚úî lubridate 1.9.4     ‚úî tidyr     1.3.1\n‚úî purrr     1.1.0     \n‚îÄ‚îÄ Conflicts ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ tidyverse_conflicts() ‚îÄ‚îÄ\n‚úñ dplyr::filter() masks stats::filter()\n‚úñ dplyr::lag()    masks stats::lag()\n‚Ñπ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 15 √ó 2\n   food        y\n   <chr>   <dbl>\n 1 cereals     3\n 2 cereals    17\n 3 cereals    12\n 4 cereals    10\n 5 cereals     4\n 6 energy     19\n 7 energy     10\n 8 energy      9\n 9 energy      7\n10 energy      5\n11 veggie     25\n12 veggie     15\n13 veggie     12\n14 veggie      9\n15 veggie      8\n```\n\n\n:::\n:::\n\n\n:::\n\n## Example - Boxplot\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](13-anova_files/figure-revealjs/unnamed-chunk-20-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n\n## Example - Test Assumptions\n\n- Assumptions:\n  + $\\sigma_1 = \\sigma_2 = \\sigma_3$ (I tested it)\n  + Data are generated from a normal distribution for each type of food.\n\n<!-- - Test for variance equality $\\sigma_1 = \\sigma_2 = \\sigma_3$ using the Levene test. I did it, and we do not reject equality of variances. -->\n\n<!-- - Test of normality using the Anderson-Darling test. I did it, and we do not reject normality assumption. -->\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](13-anova_files/figure-revealjs/unnamed-chunk-21-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n\n\n## Example - ANOVA Testing\n\n<!-- - **Step 4-c**: The critical value is $F_{\\alpha, \\, df_B, \\, df_W} = F_{0.05, \\, 3 - 1, \\, 15 - 3} = F_{0.05, \\, 2, \\, 12} = 3.89$ -->\n\n<!-- - **Step 5-c**: Since $F_{test} < F_{cri}$, we do not reject $H_0$.  -->\n\n<!-- - **Step 6**: There is insufficient evidence to support the claim that the mean isoflavone levels vary among these food items. -->\n\n<!-- -- -->\n\n\n- <span style=\"color:blue\"> $\\begin{align}&H_0: \\mu_1 = \\mu_2 = \\mu_3\\\\&H_1: \\mu_is \\text{ not all equal} \\end{align}$ </span>\n\n. . .\n\n::: center\nüòé Do all calculations and generate an ANOVA table using just one line of code! ü§ü ‚úåÔ∏è\n:::\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](./images/13-anova/anova_table_k.png){fig-align='center' width=100%}\n:::\n:::\n\n\n<!-- - More often, we like to create an ANOVA table (using R) -->\n\n<!-- - To compute the critical value, we can use R command `qf(0.05, df1 = 2, df2 = 12, lower.tail = FALSE)=` 3.88. -->\n\n\n## Example - ANOVA Table\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-line-numbers=\"false\"}\nanova(lm(y ~ food, data = data_anova))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Variance Table\n\nResponse: y\n          Df Sum Sq Mean Sq F value Pr(>F)\nfood       2   60.4   30.20   0.828   0.46\nResiduals 12  437.6   36.47               \n```\n\n\n:::\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](./images/13-anova/anova_table_k.png){fig-align='center' width=100%}\n:::\n:::\n\n\n\n\n::: notes\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tOne-way analysis of means\n\ndata:  y and food\nF = 0.8282, num df = 2, denom df = 12, p-value = 0.46\n```\n\n\n:::\n:::\n\n:::\n\n",
    "supporting": [
      "13-anova_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}